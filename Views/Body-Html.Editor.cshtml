
@using Orchard.Themes.Models
@using Orchard.Themes.Preview
@using Orchard.Themes.Services
@using Orchard.Themes.ViewModels
@{ 
    Script.Require("OrchardTinyMceDeluxe");
    var pluginsBaseUrl = Url.Content("~/modules/tinymcedeluxe/scripts/plugins");

    var siteThemeService = WorkContext.Resolve<ISiteThemeService>();
    var themeName = siteThemeService.GetSiteTheme().Name;
    var themeCssPath = @Url.Content("~/themes/"+themeName+"/styles/custom.css");
}
@Html.TextArea("Text", (string)Model.Text, 25, 80,
	 new Dictionary<string,object> {
		{"class", "html tinymce"},
		{"data-mediapicker-uploadpath",Model.AddMediaPath},
		{"data-mediapicker-title",T("Insert/Update Media")},
        {"style", "width:100%"}
	 })
<!-- Don't use this yet. It will probably fail on pages that have more than one textarea using TinyMce. In most cases this isn't an issue.  -->
@using (Script.Foot()) {
<script type="text/javascript">
    $(document).ready(function () {
        ////
        ////
        //// list the plug-ins you want to use in the plugins: property (and make sure to prefix them with a dash; e.g. to load template plugin you would do: plugins: "-template",
        //// update the value of the content_css: property to point to your site's .css file. TinyMce will load the styles from that file into a droplist in the TinyMce editor, so your content editors can apply them.

        //// Check the tinymce core plugins documentation to find out which toolbar controls are available for each plugin: http://www.tinymce.com/wiki.php/Plugins
        tinyMceDeluxe = new TinyMceDeluxe.Orchard('@pluginsBaseUrl');
        tinyMceDeluxe.init(['pagebreak', 'paste', 'table', 'template', 'syntaxhl'], {
            theme: "advanced",
            mode: "specific_textareas",
            editor_selector: "tinymce",
            plugins: "fullscreen,autoresize,searchreplace,mediapicker,inlinepopups,-table,-pagebreak,-template,-paste,-syntaxhl",
            theme_advanced_toolbar_location: "top",
            theme_advanced_toolbar_align: "left",
            theme_advanced_statusbar_location: "bottom",
            theme_advanced_resizing: "true",
            theme_advanced_buttons1: "search,replace,|,cut,copy,paste,|,undo,redo,|,link,unlink,charmap,emoticon,codeblock,|,bold,italic,|,numlist,bullist,formatselect,|,styleselect,|,syntaxhl,code,fullscreen",
            theme_advanced_buttons2: "mediapicker,|,tablecontrols,|,hr,removeformat,visualaid,|,visualchars,template,blockquote,pagebreak",
            theme_advanced_buttons3: "",
            convert_urls: false,
            template_external_list_url: "/modules/tinymcedeluxe/scripts/samples/tinymce_template_list.js",
            content_css: '@themeCssPath',
            valid_elements: "*[*]",
            // shouldn't be needed due to the valid_elements setting, but TinyMCE would strip script.src without it.
            extended_valid_elements: "script[type|defer|src|language]"
        });
    });
</script>
}